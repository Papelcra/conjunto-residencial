{% extends "base.html" %}

{% block title %}Historial de Pagos{% endblock %}

{% block content %}

<div class="container py-4">

    <h3 class="mb-1">
        Historial — Apto {{ apartamento.identificador }}
        {% if apartamento.bloque_o_torre %}
            (Torre {{ apartamento.bloque_o_torre }})
        {% endif %}
    </h3>

    <p class="text-muted">
        Residente:
        {% if apartamento.ocupante_actual %}
            {{ apartamento.ocupante_actual.get_full_name|default:apartamento.ocupante_actual.username }}
        {% else %}
            Sin residente asignado
        {% endif %}
    </p>

    <div class="card shadow-sm">
        <div class="card-body p-0">

            <table class="table table-striped mb-0">
                <thead class="table-light">
                    <tr>
                        <th>Fecha de pago</th>
                        <th>Valor pagado</th>
                        <th>Estado</th>
                    </tr>
                </thead>

                <tbody>
                    {% for p in pagos %}
                    <tr>
                        <td>{{ p.fecha_pago|date:"d/m/Y" }}</td>

                        <td>
                            $ {{ p.monto|floatformat:0 }}
                        </td>

                        <td>
                            {% if p.estado == "aprobado" %}
                                <span class="badge bg-success">Aprobado</span>
                            {% elif p.estado == "pendiente" %}
                                <span class="badge bg-warning text-dark">Pendiente</span>
                            {% else %}
                                <span class="badge bg-danger">Rechazado</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% empty %}
                    <tr>
                        <td colspan="3" class="text-center py-4 text-muted">
                            Este apartamento aún no tiene pagos registrados.
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>

            </table>

        </div>
    </div>

    <a href="{% url 'pagos:estado_pagos' %}" class="btn btn-secondary mt-3">
        ← Volver al estado de pagos
    </a>

</div>

{% endblock %}